


ARM Macro Assembler    Page 1 


    1 00000000         ;******************** (C) Ayden Dauenhauer *************
                       ******************************
    2 00000000         ; @file    HW7 Problem 2
    3 00000000         ; @author  Ayden Dauenhauer
    4 00000000         ; @date    2023
    5 00000000         ;*******************************************************
                       ******************************
    6 00000000         
    7 00000000         
    8 00000000                 AREA             main, CODE, READONLY
    9 00000000                 EXPORT           __main
   10 00000000                 ENTRY
   11 00000000         
   12 00000000         __main  PROC
   13 00000000         
   14 00000000 481A            ldr              r0, =strarray ; Pointer to arra
                                                            y of string pointer
                                                            s
   15 00000002 F04F 0107       ldr              r1, =7      ; Number of pointer
                                                            s in strarray
   16 00000006 F7FF FFFE       bl               mysort      ; Call sorting rout
                                                            ine
   17 0000000A E7FE    endless b                endless
   18 0000000C         
   19 0000000C                 ENDP
   20 0000000C         
   21 0000000C         mysort  PROC
   22 0000000C B500            push             {lr}        ; Stores the return
                                                             address
   23 0000000E 4602            mov              r2, r0      ; Copies the array 
                                                            address to r2 to be
                                                             changed later
   24 00000010 F1A1 0101 
                       loop1   sub              r1, r1, #1  ; Decrements the co
                                                            unt
   25 00000014 460F            mov              r7, r1      ; Second counter fo
                                                            r iterating the com
                                                            pare
   26 00000016 4613            mov              r3, r2      ; Set the start of 
                                                            the range
   27 00000018 461C            mov              r4, r3      ; Set to the next a
                                                            ddress part 1
   28 0000001A F104 0404       add              r4, r4, #4  ; Set to the next a
                                                            ddress part 2
   29 0000001E F7FF FFFE       bl               compare_and_swap
   30 00000022 4770            bx               lr
   31 00000024                 ENDP
   32 00000024         
   33 00000024         compare_and_swap
                               PROC
   34 00000024 B4F0            push             {r4-r7}     ; Save registers
   35 00000026 F853 5B04 
                       compareloop
                               ldr              r5, [r3], #4 ; Load the address
                                                             of the first strin
                                                            g and increment
   36 0000002A F854 6B04       ldr              r6, [r4], #4 ; Load the address
                                                             of the next string
                                                             and increment



ARM Macro Assembler    Page 2 


   37 0000002E B418            push             {r3-r4}     ; Save r3 and r4
   38 00000030 F7FF FFFE       bl               strcmp      ; Call string compa
                                                            re function
   39 00000034 BC18            pop              {r3-r4}     ; Restore r3 and r4
                                                            
   40 00000036 2800            cmp              r0, #0      ; Check strcmp resu
                                                            lt
   41 00000038 DC05            bgt              nextsmaller ; If r5 > r6 then s
                                                            wap
   42 0000003A F1A7 0701       sub              r7, r7, #1  ; Decrement the cou
                                                            nt
   43 0000003E 2F00            cmp              r7, #0      ; Check if it's at 
                                                            the end of the list
                                                            
   44 00000040 DCF1            bgt              compareloop ; If not, then keep
                                                             comparing
   45 00000042 BCF0            pop              {r4-r7}     ; Restore registers
                                                            
   46 00000044 4770            bx               lr
   47 00000046         
   48 00000046 4623    nextsmaller
                               mov              r3, r4      ; Swap the smallest
                                                             number into r3
   49 00000048 E7ED            b                compareloop ; Go back to the co
                                                            mpare function
   50 0000004A                 ENDP
   51 0000004A         
   52 0000004A         strcmp  PROC
   53 0000004A B5F0            push             {r4-r7, lr}
   54 0000004C 462C            mov              r4, r5      ; Move first string
                                                             address to r4
   55 0000004E 4635            mov              r5, r6      ; Move second strin
                                                            g address to r5
   56 00000050 F814 6B01 
                       strloop ldrb             r6, [r4], #1 ; Load byte from f
                                                            irst string and inc
                                                            rement
   57 00000054 F815 7B01       ldrb             r7, [r5], #1 ; Load byte from s
                                                            econd string and in
                                                            crement
   58 00000058 42BE            cmp              r6, r7      ; Compare bytes
   59 0000005A D102            bne              strdone     ; If different, exi
                                                            t loop
   60 0000005C 2E00            cmp              r6, #0      ; Check if end of s
                                                            tring
   61 0000005E D000            beq              strdone     ; If end, exit loop
                                                            
   62 00000060 E7F6            b                strloop     ; Repeat for next c
                                                            haracter
   63 00000062 EBA6 0007 
                       strdone sub              r0, r6, r7  ; Set result for co
                                                            mparison
   64 00000066 BDF0            pop              {r4-r7, pc} ; Restore registers
                                                             and return
   65 00000068 4770            bx               lr
   66 0000006A         
   67 0000006A                 ENDP
   68 0000006A         
   69 0000006A 00 00 00000000  AREA             mydata, DATA, READONLY



ARM Macro Assembler    Page 3 


   70 00000000 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 strarray
                               DCD              str1, str2, str3, str4, str5, s
tr6, str7
   71 0000001C 46 69 72 
              73 74 20 
              73 74 72 
              69 6E 67 
              00       str1    DCB              "First string",0
   72 00000029 53 65 63 
              6F 6E 64 
              20 73 74 
              72 69 6E 
              67 00    str2    DCB              "Second string",0
   73 00000037 53 6F 2C 
              20 64 6F 
              20 49 20 
              72 65 61 
              6C 6C 79 
              20 6E 65 
              65 64 20 
              61 20 74 
              68 69 72 
              64 20 73 
              74 72 69 
              6E 67 00 str3    DCB              "So, do I really need a third s
tring",0
   74 0000005B 54 65 74 
              72 61 70 
              68 6F 62 
              69 61 20 
              69 73 20 
              74 68 65 
              20 66 65 
              61 72 20 
              6F 66 20 
              74 68 65 
              20 6E 75 
              6D 62 65 
              72 20 34 
              00       str4    DCB              "Tetraphobia is the fear of the
 number 4",0
   75 00000083 41 20 69 
              73 20 66 
              6F 72 20 
              61 70 70 
              6C 65 00 str5    DCB              "A is for apple",0
   76 00000092 5A 20 69 
              73 20 63 
              61 6C 6C 
              65 64 20 
              27 7A 65 
              64 27 20 
              69 6E 20 



ARM Macro Assembler    Page 4 


              43 61 6E 
              61 64 61 
              00       str6    DCB              "Z is called 'zed' in Canada",0
   77 000000AE 4D 20 69 
              73 20 66 
              6F 72 20 
              6D 69 64 
              64 6C 65 
              00       str7    DCB              "M is for middle",0
   78 000000BE         END
                       
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4 --apcs=interw
ork --depend=.\objects\main.d -o.\objects\main.o -IC:\Apps\Keil_v5\ARM\RV31\INC
 -IC:\Apps\Keil_v5\ARM\CMSIS\Include --predefine="__UVISION_VERSION SETA 536" -
-list=.\listings\main.lst main.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

__main 00000000

Symbol: __main
   Definitions
      At line 12 in file main.s
   Uses
      At line 9 in file main.s
Comment: __main used once
compare_and_swap 00000024

Symbol: compare_and_swap
   Definitions
      At line 33 in file main.s
   Uses
      At line 29 in file main.s
Comment: compare_and_swap used once
compareloop 00000026

Symbol: compareloop
   Definitions
      At line 35 in file main.s
   Uses
      At line 44 in file main.s
      At line 49 in file main.s

endless 0000000A

Symbol: endless
   Definitions
      At line 17 in file main.s
   Uses
      At line 17 in file main.s
Comment: endless used once
loop1 00000010

Symbol: loop1
   Definitions
      At line 24 in file main.s
   Uses
      None
Comment: loop1 unused
main 00000000

Symbol: main
   Definitions
      At line 8 in file main.s
   Uses
      None
Comment: main unused
mysort 0000000C

Symbol: mysort
   Definitions
      At line 21 in file main.s
   Uses
      At line 16 in file main.s
Comment: mysort used once
nextsmaller 00000046




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: nextsmaller
   Definitions
      At line 48 in file main.s
   Uses
      At line 41 in file main.s
Comment: nextsmaller used once
strcmp 0000004A

Symbol: strcmp
   Definitions
      At line 52 in file main.s
   Uses
      At line 38 in file main.s
Comment: strcmp used once
strdone 00000062

Symbol: strdone
   Definitions
      At line 63 in file main.s
   Uses
      At line 59 in file main.s
      At line 61 in file main.s

strloop 00000050

Symbol: strloop
   Definitions
      At line 56 in file main.s
   Uses
      At line 62 in file main.s
Comment: strloop used once
11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

END 000000BE

Symbol: END
   Definitions
      At line 78 in file main.s
   Uses
      None
Comment: END unused
mydata 00000000

Symbol: mydata
   Definitions
      At line 69 in file main.s
   Uses
      None
Comment: mydata unused
str1 0000001C

Symbol: str1
   Definitions
      At line 71 in file main.s
   Uses
      At line 70 in file main.s
Comment: str1 used once
str2 00000029

Symbol: str2
   Definitions
      At line 72 in file main.s
   Uses
      At line 70 in file main.s
Comment: str2 used once
str3 00000037

Symbol: str3
   Definitions
      At line 73 in file main.s
   Uses
      At line 70 in file main.s
Comment: str3 used once
str4 0000005B

Symbol: str4
   Definitions
      At line 74 in file main.s
   Uses
      At line 70 in file main.s
Comment: str4 used once
str5 00000083

Symbol: str5
   Definitions
      At line 75 in file main.s
   Uses
      At line 70 in file main.s
Comment: str5 used once
str6 00000092

Symbol: str6



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 76 in file main.s
   Uses
      At line 70 in file main.s
Comment: str6 used once
str7 000000AE

Symbol: str7
   Definitions
      At line 77 in file main.s
   Uses
      At line 70 in file main.s
Comment: str7 used once
strarray 00000000

Symbol: strarray
   Definitions
      At line 70 in file main.s
   Uses
      At line 14 in file main.s
Comment: strarray used once
10 symbols
354 symbols in table
